<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amar Bazar | Pro Admin Console</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --bg: #0b1120; --card: #1e293b; --neon: #0ea5e9; --success: #22c55e; --danger: #ef4444; --warning: #f59e0b; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: white; margin: 0; padding: 0; }
        
        .sidebar { background: #0f172a; padding: 20px; text-align: center; border-bottom: 1px solid #334155; position: sticky; top: 0; z-index: 100; }
        .nav-tabs { display: flex; overflow-x: auto; gap: 10px; padding: 10px; background: #1e293b; border-bottom: 2px solid var(--neon); }
        .tab-btn { background: none; border: none; color: #94a3b8; padding: 10px 20px; cursor: pointer; font-weight: 600; white-space: nowrap; }
        .tab-btn.active { color: var(--neon); border-bottom: 2px solid var(--neon); }

        .container { padding: 20px; max-width: 800px; margin: auto; }
        .card { background: var(--card); border-radius: 15px; padding: 20px; margin-bottom: 20px; border: 1px solid #334155; }
        
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #94a3b8; font-size: 14px; }
        input, select { width: 100%; padding: 12px; background: #0f172a; border: 1px solid #334155; border-radius: 8px; color: white; box-sizing: border-box; }
        
        button { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 5px; }
        .btn-primary { background: var(--neon); color: white; }
        .btn-success { background: var(--success); color: white; }
        .btn-danger { background: var(--danger); color: white; }

        .list-item { background: #0f172a; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid var(--neon); position: relative; }
        .order-badge { padding: 4px 8px; border-radius: 5px; font-size: 11px; float: right; background: var(--warning); color: black; }
        .hidden { display: none; }
    </style>
</head>
<body>

<script>
    let pass = prompt("Admin Security Key:");
    if(pass !== "2026") { document.body.innerHTML = "<h1>Unauthorized Access</h1>"; window.stop(); }
</script>

<div class="sidebar">
    <h2 style="margin:0; color:var(--neon)">AMAR BAZAR PRO</h2>
    <p style="font-size:12px; opacity:0.7">Master Control Dashboard</p>
</div>

<div class="nav-tabs">
    <button class="tab-btn active" onclick="openTab('users')"><i class="fas fa-users"></i> Users</button>
    <button class="tab-btn" onclick="openTab('orders')"><i class="fas fa-shopping-cart"></i> Orders</button>
    <button class="tab-btn" onclick="openTab('products')"><i class="fas fa-box"></i> Products</button>
    <button class="tab-btn" onclick="openTab('settings')"><i class="fas fa-cog"></i> Settings</button>
</div>

<div class="container">
    
    <div id="users" class="tab-content">
        <div class="card">
            <h3>User Management</h3>
            <div class="input-group">
                <input id="u-id" type="tel" placeholder="User Phone Number">
            </div>
            <div class="input-group">
                <input id="u-amt" type="number" placeholder="Amount (+/-)">
            </div>
            <button class="btn-primary" onclick="manageUser('balance')">Update Balance</button>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button class="btn-danger" onclick="manageUser('Blocked')">Block</button>
                <button class="btn-success" onclick="manageUser('Active')">Unblock</button>
            </div>
        </div>
    </div>

    <div id="orders" class="tab-content hidden">
        <h3>Live Orders</h3>
        <div id="master-order-list"></div>
    </div>

    <div id="products" class="tab-content hidden">
        <div class="card">
            <h3>Update Product Price</h3>
            <select id="p-name">
                <option value="milk">Milk (1L)</option>
                <option value="honey">Honey (500g)</option>
                <option value="oil">Cooking Oil (1L)</option>
                <option value="egg">Egg (1 Dozen)</option>
            </select>
            <input id="p-price" type="number" placeholder="New Price" style="margin-top:10px;">
            <button class="btn-primary" onclick="updatePrice()">Update Live Price</button>
        </div>
    </div>

    <div id="settings" class="tab-content hidden">
        <div class="card">
            <h3>Global Notice</h3>
            <input id="notice-msg" type="text" placeholder="Type announcement...">
            <button class="btn-success" onclick="setNotice('Active')" style="margin-top:10px;">Publish</button>
            <button class="btn-danger" onclick="setNotice('Hidden')" style="margin-top:5px;">Hide</button>
        </div>
        <div class="card">
            <h3>Service Status</h3>
            <button onclick="toggleService('recharge')" id="btn-recharge">Recharge: ON</button>
            <button onclick="toggleService('tickets')" id="btn-tickets" style="margin-top:5px;">Tickets: ON</button>
        </div>
    </div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDvSODDF6mMbMq4uAin9nn8r8RWSn6xA7c",
        authDomain: "amar-bazar-77e5d.firebaseapp.com",
        databaseURL: "https://amar-bazar-77e5d-default-rtdb.firebaseio.com",
        projectId: "amar-bazar-77e5d",
        storageBucket: "amar-bazar-77e5d.firebasestorage.app",
        messagingSenderId: "1005911914259",
        appId: "1:1005911914259:web:f6c6f999499f0f757f0ce6"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Tab Logic
    function openTab(name) {
        document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(name).classList.remove('hidden');
        event.currentTarget.classList.add('active');
    }

    // User Logic
    function manageUser(action) {
        let id = document.getElementById('u-id').value;
        if(!id) return alert("ID Required");
        if(action === 'balance') {
            let amt = parseFloat(document.getElementById('u-amt').value);
            db.ref('users/'+id).once('value', s => {
                let newBal = (s.val().balance || 0) + amt;
                db.ref('users/'+id).update({ balance: newBal });
                alert("Balance Updated!");
            });
        } else {
            db.ref('users/'+id).update({ status: action });
            alert("User Status: " + action);
        }
    }

    // Price Update Logic
    function updatePrice() {
        let name = document.getElementById('p-name').value;
        let price = document.getElementById('p-price').value;
        db.ref('prices/'+name).set(parseFloat(price));
        alert(name + " price updated to " + price);
    }

    // Order Tracking
    db.ref('orders').on('value', snap => {
        const list = document.getElementById('master-order-list');
        list.innerHTML = "";
        snap.forEach(o => {
            let d = o.val();
            list.innerHTML += `
            <div class="list-item">
                <span class="order-badge">${d.status || 'Pending'}</span>
                <b>User: ${d.userId}</b><br>
                Item: ${d.item || 'Milk'} | Qty: ${d.qty} | Bill: à§³${d.bill}<br>
                <small>${o.key}</small>
                <button onclick="db.ref('orders/${o.key}').remove()" style="width:auto; padding:5px 10px; background:var(--success); font-size:10px; margin-left:10px;">Complete</button>
            </div>`;
        });
    });

    // Settings
    function setNotice(st) {
        let m = document.getElementById('notice-msg').value;
        db.ref('app_notice').set({ message: m, status: st });
        alert("Notice " + st);
    }
</script>
</body>
</html>
